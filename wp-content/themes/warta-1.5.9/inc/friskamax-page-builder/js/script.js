
+function(t){"use strict";var e=function(){this.$body=t("body"),this.$container=t("#fsmpb-container, .fsmpb-container"),this.$mainContent=t("#fsmpb-main-content"),this.$modal=this.$container.find(".modal"),this.$modalLoading=this.$modal.filter(".loading"),this.$modalInsertElement=this.$modal.filter(".insert-element"),this.$modalEditor=this.$modal.filter("#fsmpb-modal-editor"),this.templateElement=t("#fsmpb-template-element").html(),this.templateCol=t("#fsmpb-template-col").html(),this.templateRow=t("#fsmpb-template-row").html(),this.elementCounter=0,this.setLayout(),this.init(),this.modalInsertRow(),this.InsertElement(),this.selectColumn(),this.sortable(),this.enableButtons(),this.duplicate(),this.delete(),this.edit(),this.submit()};e.prototype.init=function(){var e=this;this.$mainContent.sortable({cursor:"move",placeholder:"row placeholder",handle:".fa-arrows"}),this.$container.on("click","#fsmpb-btn-insert-element:not(.button-disabled)",function(){e.$modalInsertElement.fsmhBsModal("show")}),this.$container.on("click","#fsmpb-btn-insert-sub-row:not(.button-disabled)",function(){t("#fsmpb-modal-insert-sub-row").fsmhBsModal("show")})},e.prototype.sortable=function(){var t=this.$mainContent.find(">.row>div>.elements"),e=t.find(".sub-row .elements");t.sortable({cursor:"move",connectWith:t,placeholder:"element placeholder",handle:".fa-arrows"}),e.sortable({cursor:"move",connectWith:e,placeholder:"element placeholder"})},e.prototype.resizeHeight=function(){this.$container.find(".modal.insert-element").on("shown.bs.modal",function(){var e=t(this),n=0;e.find(".element").each(function(){var e=t(this).height();n=e>n?e:n}).height(n)})},e.prototype.enableButtons=function(){var e=t("#fsmpb-btn-insert-element").addClass("button-disabled"),n=t("#fsmpb-btn-insert-sub-row").addClass("button-disabled");this.$mainContent.find(">.row>div>.elements.selected").length&&n.removeClass("button-disabled"),this.$mainContent.find(".sub-row .elements.selected").length&&e.removeClass("button-disabled")},e.prototype.selectColumn=function(){var e=this;this.$mainContent.on("click",".elements",function(n){e.$mainContent.find(".elements").removeClass("selected"),t(this).addClass("selected"),e.enableButtons(),n.stopPropagation()})},e.prototype.setLayout=function(){var e=this,n=t("[name=fsmpb_main]").val();t.FriskaMaxHelper.isJSON(n)&&t.each(t.parseJSON(n),function(){var n=t(e.templateRow);t.each(this,function(){var i=t(e.templateCol.replace(/{{width}}/gi,this.width)),s=i.find(".elements");t.each(this.subRows,function(){var n=t(e.templateRow).addClass("sub-row");t.each(this,function(){var i=t(e.templateCol.replace(/{{width}}/gi,this.width)),s=i.find(".elements");t.each(this.elements,function(){var n=e.templateElement.replace(/{{id}}/gi,"fsmpb-element-"+e.elementCounter++).replace(/{{title}}/gi,this.title).replace(/{{subtitle}}/gi,this.subtitle);n=t(n).data(this),s.append(n)}),n.append(i)}),s.append(n)}),n.append(i)}),e.$mainContent.append(n)})},e.prototype.getData=function(){var e=[],n="";return this.$mainContent.find(">.row").each(function(){var n=[];t(this).find(">div:not(.control)").each(function(){var e=t(this),i=[];e.find(".elements .sub-row").each(function(){var e=[];t(this).find(">div:not(.control)").each(function(){var n=t(this),i=[];n.find(".elements .element").each(function(){var e=t(this).data();delete e.sortableItem,i.push(e)}),e.push({width:n.attr("class").replace(/col-xs-/i,""),elements:i})}),i.push(e)}),n.push({width:e.attr("class").replace(/col-xs-/i,""),subRows:i})}),e.push(n)}),n=e.length>0?JSON.stringify(e):"",t("[name=fsmpb_main]").val(n),n},e.prototype.duplicate=function(){var e=this;this.$mainContent.on("click",".fa-copy",function(n){e.$mainContent.find(".ui-sortable").sortable("destroy");var i=t(this).closest(".element, .row"),s=i.clone(!0).insertAfter(i);s.find(".selected").removeClass("selected"),s.is(".element")?s.attr("id","fsmpb-element-"+e.elementCounter++):s.find(".element").each(function(){t(this).attr("id","fsmpb-element-"+e.elementCounter++)}),e.sortable(),n.preventDefault()})},e.prototype.delete=function(){var e=this;this.$mainContent.on("click",".fa-times",function(){confirm(fsmpbLang.msg.delete)&&(t(this).closest(".element, .row").remove(),e.enableButtons())})},e.prototype.edit=function(){var e=this;this.$mainContent.on("click",".element .fa-pencil",function(n){var i=t(this).closest(".element");e.modalInsertElement(i.data(),i),n.preventDefault()})},e.prototype.insertRow=function(e,n){var i=this,s=t(i.templateRow),e=e?e:[12];t.each(e,function(){s.append(i.templateCol.replace(/{{width}}/gi,this))}),n?(this.$mainContent.find(">.row>div>.elements.selected").append(s.addClass("sub-row")),this.sortable()):this.$mainContent.append(s)},e.prototype.modalInsertRow=function(){var e=this;this.$modal.filter(".insert-row").each(function(){var n=t(this),i=n.find('[name="fsmpb[row]"]'),s=n.find(".columns >div");s.click(function(){var e=t(this);s.removeClass("selected"),e.addClass("selected"),i.val(e.attr("title")).focus()}),n.find("button[data-insert]").click(function(){var s=!!t(this).closest("#fsmpb-modal-insert-sub-row").length,a=i.val().split("-"),o=0;t.each(a,function(t,e){o+=parseInt(e)}),12!==o?alert(fsmpbLang.msg.invalidValue):(e.insertRow(a,s),n.fsmhBsModal("hide"))}),n.keypress(function(e){13===e.which&&t(this).find("[data-insert]").trigger("click")})})},e.prototype.modalInsertElementSubmit=function(e,n,i){var s=this;e.off("submit.fsmpb").on("submit.fsmpb",function(e){var a=t(this);switch(n.subtitle="",a.find('[name=title], [name="title[]"]').each(function(){n.subtitle+=t(this).val()+" / "}),n.subtitle=n.subtitle.replace(/ \/ $/,""),n.type){case"widget":n.action="fsmpb_widget_form_submit_ajax";break;case"custom":n.action="fsmpb_ajax_custom_sanitize_"+n.args.php_class;break;case"widget_area":n.action="fsmpb_ajax_custom_sanitize_Fsmpb_Element_Widget_Area"}t.post(ajaxurl,{action:n.action,args:n.args,formData:a.serialize()},function(e){var a;n.formData=t.FriskaMaxHelper.isJSON(e)?t.parseJSON(e):{},a=s.templateElement.replace(/{{title}}/gi,n.title).replace(/{{subtitle}}/gi,n.subtitle),a=t(a).data(n).attr("id","fsmpb-element-"+s.elementCounter++),i?i.replaceWith(a):s.$mainContent.find(".elements.selected").append(a),s.$modalLoading.fsmhBsModal("hide")}),a.fsmhBsModal("hide"),s.$modalLoading.fsmhBsModal("show"),e.preventDefault()}).on("hidden.bs.modal",function(){t(this).parent().remove()})},e.prototype.modalInsertElement=function(e,n){var i=this;switch(i.$modalLoading.fsmhBsModal("show"),delete e.sortableItem,e.type){case"widget":e.action="fsmpb_widget_form_ajax";break;case"custom":e.action="fsmpb_ajax_custom_form_"+e.args.php_class;break;case"widget_area":e.action="fsmpb_ajax_custom_form_Fsmpb_Element_Widget_Area"}t.post(ajaxurl,e,function(s){var a=t(s);i.$body.append(a),i.$modalLoading.fsmhBsModal("hide"),i.modalInsertElementSubmit(a.find(".modal").fsmhBsModal("show"),e,n)})},e.prototype.InsertElement=function(){var e=this;this.resizeHeight(),this.$modalInsertElement.on("click",".element",function(){var n=t(this);e.$modalInsertElement.fsmhBsModal("hide"),e.modalInsertElement(n.data())})},e.prototype.submit=function(){var e=this;t("#post").submit(function(n){e.getData()&&!t("#title").val()&&(alert(fsmpbLang.msg.enterTitle),t("#title").focus(),t("#publish").removeClass("button-primary-disabled").parent().find(".spinner").hide(),n.preventDefault())})},new e}(jQuery);
+function(t){"use strict";var o=function(){this.pageBuilder=t("#fsmpb_meta_box"),this.editorTools=t("#wp-content-editor-tools"),this.button=t("<button></button>",{type:"button",id:"fsmpb-switch","class":"button",text:fsmpbLang.pageBuilder}),this.postdivrich=t("#postdivrich"),this.wpEditor=this.postdivrich.find(">:not(#wp-content-wrap),#wp-content-wrap >:not(#wp-content-editor-tools),#wp-content-editor-tools :not(#fsmpb-switch)"),this.customSidebar=t("#warta_custom_sidebar_meta_box"),this.pageBuilder.length&&(this.addButton(),this.pageTemplateChange(),this.click(),this.init())};o.prototype.addButton=function(){this.editorTools.prepend(this.button)},o.prototype.pageTemplateChange=function(){var o=this;t("#page_template").on("change.fsmpb.switch",function(){"default"===t(this).val()?o.button.show():(o.button.hasClass("fsmpb-margin-bottom-5")&&o.button.trigger("click"),o.button.hide())}).trigger("change.fsmpb.switch")},o.prototype.click=function(){var o=this;this.button.click(function(){var i=t(this).toggleClass("fsmpb-margin-bottom-5");o.wpEditor.toggle(),o.pageBuilder.toggle(),o.customSidebar.toggle(),i.hasClass("fsmpb-margin-bottom-5")?i.text(fsmpbLang.exitPageBuilder):i.text(fsmpbLang.pageBuilder)})},o.prototype.init=function(){t("#fsmpb-main-content .row").length>0&&this.button.trigger("click")},new o}(jQuery);
+function(n){"use strict";var t=function(){this.$metaBox=n("#fsmpb_meta_box .inside"),this.$container=n("#fsmpb-container"),this.$button=this.$container.find('[data-toggle="full-screen"]'),this.$adminMenus=n("#wpadminbar, #adminmenuback, #adminmenuwrap"),this.click()};t.prototype.click=function(){var t=this;this.$button.click(function(){var e=n(this);t.$container.toggleClass("full-screen"),t.$adminMenus.toggle(),t.$container.hasClass("full-screen")?(t.$container.detach().appendTo("body"),e.text(fsmpbLang.exitFullScreen)):(t.$container.detach().appendTo(t.$metaBox),e.text(fsmpbLang.fullScreen))})},new t}(jQuery);